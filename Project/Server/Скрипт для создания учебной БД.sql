USE master
GO

CREATE DATABASE ABONENT_PLUS
GO

USE ABONENT_PLUS
GO

-- Изменяем формат даты на год-месяц-день
SET DATEFORMAT ymd
GO

--*****************************************************************--
----* Tables *--
----*****************************************************************--
CREATE TABLE STREET (
STREETCD INTEGER PRIMARY KEY,
STREETNM VARCHAR(35) );
CREATE TABLE SERVICES (
SERVICECD INTEGER PRIMARY KEY,
SERVICENM VARCHAR(35) );
CREATE TABLE DISREPAIR (
FAILURECD INTEGER PRIMARY KEY,
FAILURENM VARCHAR(85) );
CREATE TABLE EXECUTOR (
EXECUTORCD INTEGER PRIMARY KEY,
Fio VARCHAR(30) );
CREATE TABLE ABONENT (
ACCOUNTCD VARCHAR(6) PRIMARY KEY,
STREETCD INTEGER REFERENCES STREET
ON DELETE SET NULL,
HOUSENO SMALLINT,
FLATNO SMALLINT,
Fio VARCHAR(30),
PHONE VARCHAR(15));
CREATE TABLE NACHISLSUMMA (
NACHISLFACTCD INTEGER PRIMARY KEY,
ACCOUNTCD VARCHAR(6) NOT NULL REFERENCES ABONENT,
SERVICECD INTEGER NOT NULL REFERENCES SERVICES,
NACHISLSUM NUMERIC(15,2),
NACHISLMONTH SMALLINT,
NACHISLYEAR SMALLINT);
CREATE TABLE PAYSUMMA (
PAYFACTCD INTEGER PRIMARY KEY,
ACCOUNTCD VARCHAR(6) NOT NULL REFERENCES ABONENT,
SERVICECD INTEGER NOT NULL REFERENCES SERVICES,
PAYSUM NUMERIC(15,2),
PAYDATE DATE,
PAYMONTH SMALLINT,
PAYYEAR SMALLINT);

CREATE TABLE REQUEST (
REQUESTCD INTEGER PRIMARY KEY,
ACCOUNTCD VARCHAR(6) REFERENCES ABONENT
ON DELETE SET NULL,
EXECUTORCD INTEGER REFERENCES EXECUTOR
ON DELETE SET NULL,
FAILURECD INTEGER REFERENCES DISREPAIR
ON DELETE SET NULL,
INCOMINGDATE DATE DEFAULT GETDATE() NOT NULL,
EXECUTIONDATE DATE,
EXECUTED SMALLINT DEFAULT 0 NOT NULL);

--*****************************************************************--
--* Insert STREET *--
--*****************************************************************--
BEGIN TRANSACTION;
INSERT INTO STREET (STREETCD, STREETNM) VALUES (3, 'ВОЙКОВ ПЕРЕУЛОК');
INSERT INTO STREET (STREETCD, STREETNM) VALUES (7, 'КУТУЗОВА УЛИЦА');
INSERT INTO STREET (STREETCD, STREETNM) VALUES (6, 'МОСКОВСКАЯ УЛИЦА');
INSERT INTO STREET (STREETCD, STREETNM) VALUES (8, 'МОСКОВСКОЕ ШОССЕ');
INSERT INTO STREET (STREETCD, STREETNM) VALUES (4, 'ТАТАРСКАЯ УЛИЦА');
INSERT INTO STREET (STREETCD, STREETNM) VALUES (5, 'ГАГАРИНА УЛИЦА');
INSERT INTO STREET (STREETCD, STREETNM) VALUES (1, 'ЦИОЛКОВСКОГО УЛИЦА');
INSERT INTO STREET (STREETCD, STREETNM) VALUES (2, 'НОВАЯ УЛИЦА');
COMMIT TRANSACTION;
--*****************************************************************--
--* Insert SERVICES *--
--*****************************************************************--
BEGIN TRANSACTION;
INSERT INTO SERVICES (SERVICECD, SERVICENM) VALUES (1, 'Газоснабжение');
INSERT INTO SERVICES (SERVICECD, SERVICENM) VALUES (2, 'Электроснабжение');
INSERT INTO SERVICES (SERVICECD, SERVICENM) VALUES (3, 'Теплоснабжение');
INSERT INTO SERVICES (SERVICECD, SERVICENM) VALUES (4, 'Водоснабжение');
COMMIT TRANSACTION;
--*****************************************************************--
--* Insert DISREPAIR *--
--*****************************************************************--
BEGIN TRANSACTION;
INSERT INTO DISREPAIR (FAILURECD, FAILURENM) VALUES (1, 'Засорилась водогрейная колонка');
INSERT INTO DISREPAIR (FAILURECD, FAILURENM) VALUES (2, 'Не горит АГВ');
INSERT INTO DISREPAIR (FAILURECD, FAILURENM) VALUES (3, 'Течет из водогрейной колонки');
INSERT INTO DISREPAIR (FAILURECD, FAILURENM) VALUES (4, 'Неисправна печная горелка');
INSERT INTO DISREPAIR (FAILURECD, FAILURENM) VALUES (5, 'Неисправен газовый счетчик');
INSERT INTO DISREPAIR (FAILURECD, FAILURENM) VALUES (6, 'Плохое поступление газа на горелку плиты');
INSERT INTO DISREPAIR (FAILURECD, FAILURENM) VALUES (7, 'Туго поворачивается пробка крана плиты');
INSERT INTO DISREPAIR (FAILURECD, FAILURENM) VALUES (8, 'При закрытии краника горелка плиты не гаснет');
INSERT INTO DISREPAIR (FAILURECD, FAILURENM) VALUES (12, 'Неизвестна');
COMMIT TRANSACTION;
--*****************************************************************--
--* Insert EXECUTOR *--
--*****************************************************************--
BEGIN TRANSACTION;
INSERT INTO EXECUTOR (EXECUTORCD, Fio) VALUES (1, 'Стародубцев Е. М.');
INSERT INTO EXECUTOR (EXECUTORCD, Fio) VALUES (2, 'Булгаков Т. И.');
INSERT INTO EXECUTOR (EXECUTORCD, Fio) VALUES (3, 'Шубин В. Г.');
INSERT INTO EXECUTOR (EXECUTORCD, Fio) VALUES (4, 'Шлюков М. К.');
INSERT INTO EXECUTOR (EXECUTORCD, Fio) VALUES (5, 'Школьников С. М.');
INSERT INTO EXECUTOR (EXECUTORCD, Fio) VALUES (6, 'Степанов А. В.');
COMMIT TRANSACTION;
--*****************************************************************--
--* Insert ABONENT *--
--*****************************************************************--
BEGIN TRANSACTION;
INSERT INTO ABONENT (ACCOUNTCD, STREETCD, HOUSENO, FLATNO, Fio, PHONE) VALUES ('005488', 3, 4, 1, 'Аксенов С. А.', '556893');
INSERT INTO ABONENT (ACCOUNTCD, STREETCD, HOUSENO, FLATNO, Fio, PHONE) VALUES ('115705', 3, 1, 82, 'Мищенко Е. В.', '769975');
INSERT INTO ABONENT (ACCOUNTCD, STREETCD, HOUSENO, FLATNO, Fio, PHONE) VALUES ('015527', 3, 1, 65, 'Конюхов В. С.', '761699');
INSERT INTO ABONENT (ACCOUNTCD, STREETCD, HOUSENO, FLATNO, Fio, PHONE) VALUES ('443690', 7, 5, 1, 'Тулупова М. И.', '214833');
INSERT INTO ABONENT (ACCOUNTCD, STREETCD, HOUSENO, FLATNO, Fio, PHONE) VALUES ('136159', 7, 39, 1, 'Свирина З. А.', NULL);
INSERT INTO ABONENT (ACCOUNTCD, STREETCD, HOUSENO, FLATNO, Fio, PHONE) VALUES ('443069', 4, 51, 55, 'Стародубцев Е. В.', '683014');
INSERT INTO ABONENT (ACCOUNTCD, STREETCD, HOUSENO, FLATNO, Fio, PHONE) VALUES ('136160', 4, 9, 15, 'Шмаков С. В.', NULL);
INSERT INTO ABONENT (ACCOUNTCD, STREETCD, HOUSENO, FLATNO, Fio, PHONE) VALUES ('126112', 4, 7, 11, 'Маркова В. П.', '683301');
INSERT INTO ABONENT (ACCOUNTCD, STREETCD, HOUSENO, FLATNO, Fio, PHONE) VALUES ('136169', 4, 7, 13, 'Денисова Е. К.', '680305');
INSERT INTO ABONENT (ACCOUNTCD, STREETCD, HOUSENO, FLATNO, Fio, PHONE) VALUES ('080613', 8, 35, 11, 'Лукашина Р. М.', '254417');
INSERT INTO ABONENT (ACCOUNTCD, STREETCD, HOUSENO, FLATNO, Fio, PHONE) VALUES ('080047', 8, 39, 36, 'Шубина Т. П.', '257842');
INSERT INTO ABONENT (ACCOUNTCD, STREETCD, HOUSENO, FLATNO, Fio, PHONE) VALUES ('080270', 6, 35, 6, 'Тимошкина Н. Г.', '321002');
COMMIT TRANSACTION;
--*****************************************************************--
--* Insert NACHISLSUMMA *--
--*****************************************************************--
BEGIN TRANSACTION;
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (19, '005488', 2, 58.7, 12, 2019);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (2, '005488', 2, 46, 12, 2018);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (3, '005488', 2, 56, 4, 2021);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (4, '115705', 2, 40, 1, 2018);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (5, '115705', 2, 250, 9, 2019);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (13, '136160', 2, 20, 5, 2019);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (1, '136160', 2, 56, 1, 2021);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (15, '136169', 2, 20, 5, 2018);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (7, '080047', 2, 80, 10, 2020);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (8, '080047', 2, 80, 10, 2019);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (9, '080270', 2, 46, 12, 2019);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (10, '080613', 2, 56, 6, 2019);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (11, '115705', 2, 250, 9, 2018);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (12, '115705', 2, 58.7, 8, 2019);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (16, '136169', 2, 58.7, 11, 2019);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (17, '443069', 2, 80, 9, 2019);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (18, '443069', 2, 38.5, 8, 2019);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (6, '136160', 1, 18.3, 1, 2020);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (20, '015527', 1, 28.32, 7, 2020);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (21, '080047', 1, 19.56, 3, 2020);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (22, '080613', 1, 10.6, 9, 2020);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (23, '443069', 1, 38.28, 12, 2020);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (24, '015527', 1, 38.32, 4, 2021);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (25, '115705', 1, 37.15, 10, 2021);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (26, '080613', 1, 12.6, 8, 2018);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (27, '136169', 1, 25.32, 1, 2021);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (28, '080270', 1, 57.1, 2, 2020);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (29, '136159', 1, 8.3, 8, 2021);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (30, '005488', 1, 62.13, 4, 2018);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (31, '115705', 1, 37.8, 5, 2019);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (32, '443690', 1, 17.8, 6, 2020);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (33, '080047', 1, 22.56, 5, 2021);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (34, '126112', 1, 15.3, 8, 2018);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (35, '080047', 1, 32.56, 9, 2019);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (36, '080613', 1, 12.6, 4, 2020);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (37, '115705', 1, 37.15, 11, 2021);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (38, '080270', 1, 58.1, 12, 2018);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (39, '136169', 1, 28.32, 1, 2019);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (40, '015527', 1, 18.32, 2, 2020);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (41, '443690', 1, 21.67, 3, 2021);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (42, '080613', 1, 22.86, 4, 2018);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (43, '080270', 1, 60.1, 5, 2019);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (44, '136169', 1, 28.32, 2, 2020);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (45, '080047', 1, 22.2, 7, 2021);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (46, '126112', 1, 25.3, 8, 2019);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (47, '443069', 1, 38.32, 9, 2019);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (48, '136159', 1, 8.3, 10, 2020);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (49, '115705', 1, 37.15, 6, 2021);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (50, '136160', 1, 18.3, 12, 2018);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (51, '005488', 3, 279.8, 5, 2020);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (52, '005488', 3, 266.7, 2, 2021);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (53, '015527', 3, 343.36, 11, 2021);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (54, '080047', 3, 271.6, 2, 2021);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (55, '080270', 3, 278.25, 11, 2021);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (56, '080613', 3, 254.4, 7, 2019);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (57, '080613', 3, 258.8, 2, 2021);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (58, '080613', 3, 239.33, 5, 2021);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (59, '126112', 3, 179.9, 4, 2020);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (60, '136159', 3, 180.13, 9, 2021);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (61, '136160', 3, 238.8, 3, 2018);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (62, '136160', 3, 237.38, 3, 2019);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (63, '136169', 3, 349.19, 6, 2020);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (64, '136169', 3, 346.18, 7, 2020);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (65, '443690', 3, 290.33, 3, 2021);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (66, '015527', 4, 580.1, 7, 2020);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (67, '015527', 4, 611.3, 10, 2021);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (68, '080270', 4, 444.34, 3, 2019);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (69, '080270', 4, 453.43, 6, 2020);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (70, '080270', 4, 454.6, 4, 2021);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (71, '115705', 4, 553.85, 1, 2020);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (72, '126112', 4, 435.5, 6, 2020);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (73, '136159', 4, 349.38, 4, 2019);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (74, '136159', 4, 418.88, 6, 2020);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (75, '136169', 4, 528.44, 10, 2021);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (76, '443069', 4, 466.69, 5, 2020);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (77, '443069', 4, 444.45, 10, 2021);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (78, '443690', 4, 480.88, 8, 2019);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (79, '443690', 4, 500.13, 9, 2020);
COMMIT TRANSACTION;
--*****************************************************************--
--* Insert PAYSUMMA *--
--*****************************************************************--
BEGIN TRANSACTION;
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (1, '005488', 2, 58.7, CONVERT(DATETIME, '2020-01-08'), 12, 2019);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (2, '005488', 2, 40, CONVERT(DATETIME, '2019-01-06'), 12, 2018);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (3, '005488', 2, 56, CONVERT(DATETIME, '2021-05-06'), 4, 2021);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (4, '115705', 2, 40, CONVERT(DATETIME, '2018-02-10'), 1, 2018);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (5, '115705', 2, 250, CONVERT(DATETIME, '2019-10-03'), 9, 2019);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (6, '136160', 2, 20, CONVERT(DATETIME, '2019-06-13'), 5, 2019);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (7, '136160', 2, 56, CONVERT(DATETIME, '2021-02-12'), 1, 2021);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (8, '136169', 2, 20, CONVERT(DATETIME, '2019-06-22'), 5, 2019);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (9, '080047', 2, 80, CONVERT(DATETIME, '2020-11-26'), 10, 2020);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (10, '080047', 2, 80, CONVERT(DATETIME, '2019-11-21'), 10, 2019);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (11, '080270', 2, 30, CONVERT(DATETIME, '2020-01-03'), 12, 2019);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (12, '080613', 2, 58.5, CONVERT(DATETIME, '2019-07-19'), 6, 2019);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (13, '115705', 2, 250, CONVERT(DATETIME, '2018-10-06'), 9, 2018);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (14, '115705', 2, 58.7, CONVERT(DATETIME, '2019-09-04'), 8, 2019);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (15, '136169', 2, 58.7, CONVERT(DATETIME, '2019-12-01'), 11, 2019);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (16, '443069', 2, 80, CONVERT(DATETIME, '2019-10-03'), 9, 2019);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (17, '443069', 2, 38.5, CONVERT(DATETIME, '2019-09-13'), 8, 2019);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (18, '136160', 1, 18, CONVERT(DATETIME, '2020-02-05'), 1, 2020);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (19, '015527', 1, 30, CONVERT(DATETIME, '2020-08-03'), 7, 2020);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (20, '080047', 1, 19.56, CONVERT(DATETIME, '2020-04-02'), 3, 2020);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (21, '080613', 1, 11, CONVERT(DATETIME, '2020-10-03'), 9, 2020);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (22, '443069', 1, 38.28, CONVERT(DATETIME, '2021-02-04'), 12, 2020);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (23, '015527', 1, 40, CONVERT(DATETIME, '2021-05-07'), 4, 2021);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (24, '115705', 1, 37.15, CONVERT(DATETIME, '2021-11-04'), 10, 2021);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (25, '080613', 1, 12, CONVERT(DATETIME, '2018-09-20'), 8, 2018);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (26, '136169', 1, 25.32, CONVERT(DATETIME, '2021-02-03'), 1, 2021);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (27, '080270', 1, 60, CONVERT(DATETIME, '2020-03-05'), 2, 2021);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (28, '136159', 1, 8.3, CONVERT(DATETIME, '2021-09-10'), 8, 2021);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (29, '005488', 1, 65, CONVERT(DATETIME, '2018-05-03'), 4, 2018);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (30, '115705', 1, 37.8, CONVERT(DATETIME, '2019-07-12'), 5, 2019);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (31, '443690', 1, 20, CONVERT(DATETIME, '2020-07-10'), 6, 2020);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (32, '080047', 1, 22.56, CONVERT(DATETIME, '2021-06-25'), 5, 2021);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (33, '126112', 1, 15.3, CONVERT(DATETIME, '2018-09-08'), 8, 2018);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (34, '080047', 1, 32.56, CONVERT(DATETIME, '2019-10-18'), 9, 2019);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (35, '080613', 1, 12.6, CONVERT(DATETIME, '2020-05-22'), 4, 2020);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (36, '115705', 1, 37.15, CONVERT(DATETIME, '2021-12-23'), 11, 2021);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (37, '080270', 1, 58.1, CONVERT(DATETIME, '2019-01-07'), 12, 2018);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (38, '136169', 1, 28.32, CONVERT(DATETIME, '2019-02-08'), 1, 2019);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (39, '015527', 1, 20, CONVERT(DATETIME, '2020-03-18'), 2, 2020);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (40, '443690', 1, 19.47, CONVERT(DATETIME, '2021-04-10'), 3, 2021);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (41, '080613', 1, 22.86, CONVERT(DATETIME, '2018-05-04'), 4, 2018);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (42, '080270', 1, 60, CONVERT(DATETIME, '2019-06-07'), 5, 2019);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (43, '136169', 1, 28.32, CONVERT(DATETIME, '2020-03-05'), 2, 2020);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (44, '080047', 1, 22.2, CONVERT(DATETIME, '2021-08-10'), 7, 2021);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (45, '126112', 1, 25.3, CONVERT(DATETIME, '2019-09-10'), 8, 2019);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (46, '443069', 1, 38.32, CONVERT(DATETIME, '2019-10-09'), 9, 2019);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (47, '136159', 1, 8.3, CONVERT(DATETIME, '2020-11-14'), 10, 2020);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (48, '115705', 1, 37.15, CONVERT(DATETIME, '2021-08-10'), 6, 2021);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (49, '136160', 1, 16, CONVERT(DATETIME, '2019-01-07'), 12, 2018);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (50, '005488', 3, 280, CONVERT(DATETIME, '2020-06-10'), 5, 2020);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (51, '005488', 3, 260, CONVERT(DATETIME, '2021-03-11'), 2, 2021);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (52, '015527', 3, 345, CONVERT(DATETIME, '2021-12-15'), 11, 2021);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (53, '080047', 3, 271.6, CONVERT(DATETIME, '2021-03-12'), 2, 2021);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (54, '080270', 3, 278, CONVERT(DATETIME, '2021-12-06'), 11, 2021);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (55, '080613', 3, 254.4, CONVERT(DATETIME, '2019-08-10'), 7, 2019);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (56, '080613', 3, 258.8, CONVERT(DATETIME, '2021-03-8'), 2, 2021);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (57, '080613', 3, 239.35, CONVERT(DATETIME, '2021-06-11'), 5, 2021);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (58, '126112', 3, 179.9, CONVERT(DATETIME, '2020-05-01'), 4, 2020);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (59, '136159', 3, 180.13, CONVERT(DATETIME, '2021-10-21'), 9, 2021);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (60, '136160', 3, 240, CONVERT(DATETIME, '2018-04-04'), 3, 2018);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (61, '136160', 3, 200, CONVERT(DATETIME, '2019-04-06'), 3, 2019);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (62, '136169', 3, 349.19, CONVERT(DATETIME, '2020-07-14'), 6, 2020);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (63, '136169', 3, 346.18, CONVERT(DATETIME, '2020-08-13'), 7, 2020);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (64, '443690', 3, 295, CONVERT(DATETIME, '2021-04-09'), 3, 2021);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (65, '015527', 4, 580.1, CONVERT(DATETIME, '2020-08-08'), 7, 2020);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (66, '015527', 4, 611.3, CONVERT(DATETIME, '2021-11-03'), 10, 2021);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (67, '080270', 4, 444.5, CONVERT(DATETIME, '2019-04-18'), 3, 2019);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (68, '080270', 4, 450, CONVERT(DATETIME, '2020-07-14'), 6, 2020);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (69, '080270', 4, 460, CONVERT(DATETIME, '2021-05-12'), 4, 2021);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (70, '115705', 4, 553.85, CONVERT(DATETIME, '2020-02-02'), 1, 2020);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (71, '126112', 4, 435.5, CONVERT(DATETIME, '2020-07-12'), 6, 2020);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (72, '136159', 4, 349.38, CONVERT(DATETIME, '2019-05-18'), 4, 2019);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (73, '136159', 4, 420, CONVERT(DATETIME, '2020-07-09'), 6, 2020);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (74, '136169', 4, 528.44, CONVERT(DATETIME, '2021-11-26'), 10, 2021);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (75, '443069', 4, 466.69, CONVERT(DATETIME, '2020-06-03'), 5, 2020);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (76, '443069', 4, 444.45, CONVERT(DATETIME, '2021-11-16'), 10, 2021);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (77, '443690', 4, 485, CONVERT(DATETIME, '2019-09-05'), 8, 2019);
COMMIT TRANSACTION;
--*****************************************************************--
--* Insert REQUEST *--
--*****************************************************************--
BEGIN TRANSACTION;
INSERT INTO REQUEST (REQUESTCD, ACCOUNTCD, EXECUTORCD, FAILURECD, INCOMINGDATE, EXECUTIONDATE, EXECUTED) VALUES (1, '005488', 1, 1, CONVERT(DATETIME, '2019-12-17'), CONVERT(DATETIME, '2019-12-20'), 1);
INSERT INTO REQUEST (REQUESTCD, ACCOUNTCD, EXECUTORCD, FAILURECD, INCOMINGDATE, EXECUTIONDATE, EXECUTED) VALUES (2, '115705', 3, 1, CONVERT(DATETIME, '2019-08-07'), CONVERT(DATETIME, '2019-08-12'), 1);
INSERT INTO REQUEST (REQUESTCD, ACCOUNTCD, EXECUTORCD, FAILURECD, INCOMINGDATE, EXECUTIONDATE, EXECUTED) VALUES (3, '015527', 1, 12, CONVERT(DATETIME, '2020-02-28'), CONVERT(DATETIME, '2020-03-08'), 0);
INSERT INTO REQUEST (REQUESTCD, ACCOUNTCD, EXECUTORCD, FAILURECD, INCOMINGDATE, EXECUTIONDATE, EXECUTED) VALUES (5, '080270', 4, 1, CONVERT(DATETIME, '2019-12-31'), NULL, 0);
INSERT INTO REQUEST (REQUESTCD, ACCOUNTCD, EXECUTORCD, FAILURECD, INCOMINGDATE, EXECUTIONDATE, EXECUTED) VALUES (6, '080613', 1, 6, CONVERT(DATETIME, '2019-06-16'), CONVERT(DATETIME, '2019-06-24'), 1);
INSERT INTO REQUEST (REQUESTCD, ACCOUNTCD, EXECUTORCD, FAILURECD, INCOMINGDATE, EXECUTIONDATE, EXECUTED) VALUES (7, '080047', 3, 2, CONVERT(DATETIME, '2020-10-20'), CONVERT(DATETIME, '2020-10-24'), 1);
INSERT INTO REQUEST (REQUESTCD, ACCOUNTCD, EXECUTORCD, FAILURECD, INCOMINGDATE, EXECUTIONDATE, EXECUTED) VALUES (9, '136169', 2, 1, CONVERT(DATETIME, '2019-11-06'), CONVERT(DATETIME, '2019-11-08'), 1);
INSERT INTO REQUEST (REQUESTCD, ACCOUNTCD, EXECUTORCD, FAILURECD, INCOMINGDATE, EXECUTIONDATE, EXECUTED) VALUES (10, '136159', 3, 12, CONVERT(DATETIME, '2019-04-01'), CONVERT(DATETIME, '2019-04-03'), 0);
INSERT INTO REQUEST (REQUESTCD, ACCOUNTCD, EXECUTORCD, FAILURECD, INCOMINGDATE, EXECUTIONDATE, EXECUTED) VALUES (11, '136160', 1, 6, CONVERT(DATETIME, '2021-01-12'), CONVERT(DATETIME, '2021-01-12'), 1);
INSERT INTO REQUEST (REQUESTCD, ACCOUNTCD, EXECUTORCD, FAILURECD, INCOMINGDATE, EXECUTIONDATE, EXECUTED) VALUES (12, '443069', 5, 2, CONVERT(DATETIME, '2019-08-08'), CONVERT(DATETIME, '2019-08-10'), 1);
INSERT INTO REQUEST (REQUESTCD, ACCOUNTCD, EXECUTORCD, FAILURECD, INCOMINGDATE, EXECUTIONDATE, EXECUTED) VALUES (13, '005488', 5, 8, CONVERT(DATETIME, '2018-09-04'), CONVERT(DATETIME, '2018-12-05'), 1);
INSERT INTO REQUEST (REQUESTCD, ACCOUNTCD, EXECUTORCD, FAILURECD, INCOMINGDATE, EXECUTIONDATE, EXECUTED) VALUES (14, '005488', 4, 6, CONVERT(DATETIME, '2021-04-04'), CONVERT(DATETIME, '2021-04-13'), 1);
INSERT INTO REQUEST (REQUESTCD, ACCOUNTCD, EXECUTORCD, FAILURECD, INCOMINGDATE, EXECUTIONDATE, EXECUTED) VALUES (15, '115705', 4, 5, CONVERT(DATETIME, '2018-09-20'), CONVERT(DATETIME, '2018-09-23'), 1);
INSERT INTO REQUEST (REQUESTCD, ACCOUNTCD, EXECUTORCD, FAILURECD, INCOMINGDATE, EXECUTIONDATE, EXECUTED) VALUES (16, '115705', NULL, 3, CONVERT(DATETIME, '2019-12-28'), NULL, 0);
INSERT INTO REQUEST (REQUESTCD, ACCOUNTCD, EXECUTORCD, FAILURECD, INCOMINGDATE, EXECUTIONDATE, EXECUTED) VALUES (17, '115705', 1, 5, CONVERT(DATETIME, '2019-08-15'), CONVERT(DATETIME, '2019-09-06'), 1);
INSERT INTO REQUEST (REQUESTCD, ACCOUNTCD, EXECUTORCD, FAILURECD, INCOMINGDATE, EXECUTIONDATE, EXECUTED) VALUES (18, '115705', 2, 3, CONVERT(DATETIME, '2020-12-28'), CONVERT(DATETIME, '2021-01-04'), 1);
INSERT INTO REQUEST (REQUESTCD, ACCOUNTCD, EXECUTORCD, FAILURECD, INCOMINGDATE, EXECUTIONDATE, EXECUTED) VALUES (19, '080270', 4, 8, CONVERT(DATETIME, '2019-12-17'), CONVERT(DATETIME, '2019-12-27'), 1);
INSERT INTO REQUEST (REQUESTCD, ACCOUNTCD, EXECUTORCD, FAILURECD, INCOMINGDATE, EXECUTIONDATE, EXECUTED) VALUES (20, '080047', 3, 2, CONVERT(DATETIME, '2019-10-11'), CONVERT(DATETIME, '2019-10-11'), 1);
INSERT INTO REQUEST (REQUESTCD, ACCOUNTCD, EXECUTORCD, FAILURECD, INCOMINGDATE, EXECUTIONDATE, EXECUTED) VALUES (21, '443069', 1, 2, CONVERT(DATETIME, '2019-09-13'), CONVERT(DATETIME, '2019-09-14'), 1);
INSERT INTO REQUEST (REQUESTCD, ACCOUNTCD, EXECUTORCD, FAILURECD, INCOMINGDATE, EXECUTIONDATE, EXECUTED) VALUES (22, '136160', 1, 7, CONVERT(DATETIME, '2019-05-18'), CONVERT(DATETIME, '2019-05-25'), 1);
INSERT INTO REQUEST (REQUESTCD, ACCOUNTCD, EXECUTORCD, FAILURECD, INCOMINGDATE, EXECUTIONDATE, EXECUTED) VALUES (23, '136169', 5, 7, CONVERT(DATETIME, '2019-05-07'), CONVERT(DATETIME, '2019-05-08'), 1);
UPDATE Nachislsumma SET NachislSum=NachislSum+500 WHERE Servicecd=1;
UPDATE Nachislsumma SET NachislSum=NachislSum+600 WHERE Servicecd=2;
UPDATE Nachislsumma SET NachislSum=NachislSum+2000 WHERE Servicecd=3;
UPDATE Nachislsumma SET NachislSum=NachislSum-300 WHERE Servicecd=4;
UPDATE Paysumma SET PaySum=PaySum+500 WHERE Servicecd=1;
UPDATE Paysumma SET PaySum=PaySum+600 WHERE Servicecd=2;
UPDATE Paysumma SET Paysum=Paysum+2000 WHERE Servicecd=3;
UPDATE Paysumma SET Paysum=Paysum-300 WHERE Servicecd=4;
COMMIT TRANSACTION;
BEGIN TRANSACTION
--
-- Описание для триггера UC_ABONENT_NACHISLSUMMA
--
--GO
--CREATE TRIGGER UC_ABONENT_NACHISLSUMMA
--ON ABONENT
--AFTER UPDATE
--FOR EACH ROW
--WHEN (NEW.accountcd != old.accountcd)
--BEGIN
--UPDATE NACHISLSUMMA
--SET accountcd = :new.accountcd
--WHERE accountcd = :old.accountcd;
--END;
----
---- Описание для триггера UC_ABONENT_PAYSUMMA
----
--GO
--CREATE TRIGGER UC_ABONENT_PAYSUMMA
--ON ABONENT
--AFTER UPDATE
--FOR EACH ROW
--WHEN (NEW.accountcd != old.accountcd)
--BEGIN
--UPDATE PAYSUMMA
--SET accountcd = :new.accountcd
--WHERE accountcd = :old.accountcd;
--END;
----
---- Описание для триггера UC_ABONENT_REQUEST
----
--GO
--CREATE OR ALTER TRIGGER UC_ABONENT_REQUEST
--ON ABONENT
--AFTER UPDATE
--FOR EACH ROW
--WHEN (NEW.accountcd != old.accountcd)
--BEGIN
--UPDATE REQUEST
--SET accountcd = :new.accountcd
--WHERE accountcd = :old.accountcd;
--END;
--GO
----
---- Описание для триггера UC_DISREPAIR_REQUEST
----
--CREATE OR ALTER TRIGGER UC_DISREPAIR_REQUEST
--ON DISREPAIR
--AFTER UPDATE
--FOR EACH ROW
--WHEN (NEW.failurecd != old.failurecd)
--BEGIN
--UPDATE REQUEST
--SET failurecd = :new.failurecd
--WHERE failurecd = :old.failurecd;
--END;
--GO
----
---- Описание для триггера UC_EXECUTOR_REQUEST
----
--CREATE OR ALTER TRIGGER UC_EXECUTOR_REQUEST
--ON EXECUTOR
--AFTER UPDATE
--FOR EACH ROW
--WHEN (NEW.executorcd != old.executorcd)
--BEGIN
--UPDATE REQUEST
--SET executorcd = :new.executorcd
--WHERE executorcd = :old.executorcd;
--END;
--GO
----
---- Описание для триггера UC_SERVICES_NACHISLSUMMA
----
--CREATE OR ALTER TRIGGER UC_SERVICES_NACHISLSUMMA
--ON SERVICES
--AFTER UPDATE
--FOR EACH ROW
--WHEN (NEW.servicecd != old.servicecd)
--BEGIN
--UPDATE NACHISLSUMMA
--SET servicecd = :new.servicecd
--WHERE servicecd = :old.servicecd;
--END;
--GO
----
---- Описание для триггера UC_SERVICES_PAYSUMMA
----
--CREATE OR ALTER TRIGGER UC_SERVICES_PAYSUMMA
--ON SERVICES
--AFTER UPDATE
--FOR EACH ROW
--WHEN (NEW.servicecd != old.servicecd)
--BEGIN
--UPDATE PAYSUMMA
--SET servicecd = :new.servicecd
--WHERE servicecd = :old.servicecd;
--END;
--GO
----
---- Описание для триггера UC_STREET_ABONENT
----
--CREATE OR ALTER TRIGGER UC_STREET_ABONENT
--ON STREET
--AFTER UPDATE
--FOR EACH ROW
--WHEN (NEW.streetcd != old.streetcd)
--BEGIN
--UPDATE ABONENT
--SET streetcd = :new.streetcd
--WHERE streetcd = :old.streetcd;
--END;
--GO
----
---- Описание для триггера TD_ABONENT
----
--CREATE TRIGGER TD_ABONENT
--ON ABONENT
--AFTER DELETE
--REFERENCING NEW AS new OLD AS old
--FOR EACH ROW
--DECLARE
--NUMROWS INTEGER;
--BEGIN
--SELECT COUNT(*)
--INTO NUMROWS
--FROM NACHISLSUMMA
--WHERE NACHISLSUMMA.ACCOUNTCD = :OLD.ACCOUNTCD;
--IF (NUMROWS > 0)
--THEN
--RAISE_APPLICATION_ERROR(-20001, 'Ограничение удаления записи из родительской таблицы');
--END IF;
--SELECT COUNT(*)
--INTO NUMROWS
--FROM PAYSUMMA
--WHERE PAYSUMMA.ACCOUNTCD = :OLD.ACCOUNTCD;
--IF (NUMROWS > 0)
--THEN
--RAISE_APPLICATION_ERROR(-20001, 'Ограничение удаления записи из родительской таблицы');
--END IF;
--END;
--GO
----
---- Описание для триггера TD_SERVICES
----
--CREATE TRIGGER TD_SERVICES
--ON SERVICES
--AFTER DELETE
--REFERENCING NEW AS new OLD AS old
--FOR EACH ROW
--DECLARE
--NUMROWS INTEGER;
--BEGIN
--SELECT COUNT(*)
--INTO NUMROWS
--FROM NACHISLSUMMA
--WHERE NACHISLSUMMA.SERVICECD = :OLD.SERVICECD;
--IF (NUMROWS > 0)
--THEN
--RAISE_APPLICATION_ERROR(-20001, 'Ограничение удаления записи из родительской таблицы');
--END IF;
--SELECT COUNT(*)
--INTO NUMROWS
--FROM PAYSUMMA
--WHERE PAYSUMMA.SERVICECD = :OLD.SERVICECD;
--IF (NUMROWS > 0)
--THEN
--RAISE_APPLICATION_ERROR(-20001, 'Ограничение удаления записи из родительской таблицы');
--END IF;
--END;
--GO
--COMMIT TRANSACTION;